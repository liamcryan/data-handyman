<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
         
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Python-pptx Tables</title>
        <style>

    html body {
        font-family: Raleway, sans-serif;
        background-color: beige;
    }

    :root {
        --accent: brown;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/css/posts.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

     <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/swift.min.js"></script> 

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106240485-1', 'auto');
  ga('send', 'pageview');

</script>
 <meta name="generator" content="Hugo 0.26" />
        
    </head>

    <body>

        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">Python-pptx Tables</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/project/">Projects</a></li>
                            
                                <li><a href="/contact/">Contact</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:liam@data-handyman.com"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/liamcryan/"><i class="fa fa-github"></i></a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>


<main>

    <div class="item">

    
    
    

    
    

    <h4><a href="/post/python-pptx/">Python-pptx Tables</a></h4>
    
    
    <h5>December 15, 2017</h5>
    

     <kbd class="item-tag">python</kbd>  <kbd class="item-tag">ppt</kbd>  <kbd class="item-tag">table</kbd> 

</div>


    <br> <div class="text-justify">

<h2 id="power-point-is-where-it-s-at-people">Power Point is where it&rsquo;s at people</h2>

<h4 id="here-is-a-scenario-from-a-few-months-ago">Here is a scenario from a few months ago:</h4>

<blockquote>
<p>I create a weekly PowerPoint presentation that relies on some data processing.  The process
of creating this PowerPoint is a mixture of manual and automated methods.  My boss says,</p>

<blockquote>
<p>&ldquo;Hey, we have been asked to put the contents of the weekly PowerPoint presentation into a mobile app.&rdquo;</p>

<p>&ldquo;How exciting,&rdquo; I exclaim as I realize our current data flow is not good enough.</p>
</blockquote>
</blockquote>

<h4 id="fast-forward-to-less-than-a-few-months-ago">Fast forward to less than a few months ago:</h4>

<blockquote>
<p>Sweet, the data flow is automatic and feeding the mobile app nicely.  Thanks Python.
Do we really need the PowerPoint anymore?  I hear, &ldquo;yes, we do.&rdquo;</p>

<p>Do we really?  In this day and age?  Ok, let&rsquo;s do it.  Python, what do you have for me?</p>
</blockquote>

<h2 id="python-pptx">Python-pptx</h2>

<p><a href="https://github.com/scanny/python-pptx">Python-pptx</a> is a library that will help you
 to create PowerPoint Presentations programatically.</p>

<h2 id="my-powerpoint-presentations">My PowerPoint Presentations</h2>

<p>The PowerPoint presentation I help with each week contains text, tables, and charts.
The tables and charts will need to be populated with changing data coming from a database.
I want to talk about tables this time.  Suppose the data looks something like this:</p>

<pre><code class="language-json">{
  &quot;average_number_of_miles&quot;: 7.1,
  &quot;week&quot;: 1,
  &quot;car&quot;: &quot;Toyota&quot;
},
{
  &quot;average_number_of_miles&quot;: 5.6,
  &quot;week&quot;: 2,
  &quot;car&quot;: &quot;Toyota&quot;
},
{
  &quot;average_number_of_miles&quot;: 4.4,
  &quot;week&quot;: 3,
  &quot;car&quot;: &quot;Toyota&quot;
}
</code></pre>

<p>Here is how you can create a slide and put in a table with Python-pptx:</p>

<pre><code class="language-python">from pptx import Presentation
from pptx.util import Inches


data = [{&quot;average_number_of_miles&quot;: 7.1, &quot;week&quot;: 1, &quot;car&quot;: &quot;Toyota&quot;},
        {&quot;average_number_of_miles&quot;: 5.6, &quot;week&quot;: 2, &quot;car&quot;: &quot;Toyota&quot;},
        {&quot;average_number_of_miles&quot;: 4.4, &quot;week&quot;: 3, &quot;car&quot;: &quot;Toyota&quot;}]

prs = Presentation()
slide_layout = prs.slide_layouts[1]
slide = prs.slides.add_slide(slide_layout)
shapes = slide.shapes

rows = 4
cols = 3
left = Inches(3.0)
top = Inches(3.0)
width = Inches(6.0)
height = Inches(1.5)

table = shapes.add_table(rows, cols, left, top, width, height).table

# column headers
table.cell(0, 0).text = &quot;average_number_of_miles&quot;
table.cell(0, 1).text = &quot;week&quot;
table.cell(0, 2).text = &quot;car&quot;

# rows of data
for i in range(0, 3):
  table.cell(i+1, 0).text = data[i][&quot;average_number_of_miles&quot;]
  table.cell(i+1, 1).text = str(data[i][&quot;week&quot;])
  table.cell(i+1, 2).text = str(data[i][&quot;car&quot;])

prs.save('table1.pptx')
</code></pre>

<p>And voila! A slide with your table!</p>

<p><img src="/img/table1.png"> </img></p>

<p>Using Python-pptx takes quite a bit of lines of code to create a slide with a table on it.  I wanted to create a library that
made this process easier.  Hence ppt-tables.</p>

<h2 id="pptx-tables">pptx-tables</h2>

<p>pptx-tables is a Python library that helps you get data into a PowerPoint table through
the help of Python-pptx.</p>

<p>The basic idea is that you feed the data and pptx-tables will put a basic
table on a PowerPoint with this data.  It is meant to make life a little bit easier.</p>

<p>Here is how much easier.  This will accomplish the same as above:</p>

<pre><code class="language-python">from pptx_tables imort PptxTable

data = [{&quot;average_number_of_miles&quot;: 7.1, &quot;week&quot;: 1, &quot;car&quot;: &quot;Toyota&quot;},
        {&quot;average_number_of_miles&quot;: 5.6, &quot;week&quot;: 2, &quot;car&quot;: &quot;Toyota&quot;},
        {&quot;average_number_of_miles&quot;: 4.4, &quot;week&quot;: 3, &quot;car&quot;: &quot;Toyota&quot;}]

tbl = PptxTable(data)
tbl.set_table_location(left=Inches(3), top=Inches(3), width=Inches(6), height=Inches(1.5))
tbl.create_table(columns_sort_order=[&quot;average_number_of_miles&quot;, &quot;week&quot;, &quot;car&quot;]
                  columns_headers=[&quot;average_number_of_miles&quot;, &quot;week&quot;, &quot;car&quot;])

tbl.save_pptx(&quot;table2.pptx&quot;)
</code></pre>

<p>Wow, practically the same slide as before!</p>

<p><img src="/img/table2.png"> </img></p>

<p>I am happy to use pptx-tables as an aid for creating the weekly PowerPoint Presentation.  There
are also quite a few things you can do to your tables.  See some examples here: <a href="https://github.com/liamcryan/pptx-tables/blob/master/README.rst">README</a></p>
</div>

    
    

    

        <h4 class="page-header">Related</h4>

         <div class="item">

    
    
    

    
    

    <h4><a href="/post/python-google-calendar2/">Python Google Calendar - part 2</a></h4>
    
    
    <h5>November 17, 2017</h5>
    

     <kbd class="item-tag">google calendar</kbd>  <kbd class="item-tag">python</kbd>  <kbd class="item-tag">create</kbd> 

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/python-google-calendar1/">Python Google Calendar - part 1</a></h4>
    
    
    <h5>November 7, 2017</h5>
    

     <kbd class="item-tag">google calendar</kbd>  <kbd class="item-tag">python</kbd>  <kbd class="item-tag">quickstart</kbd> 

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/python-gmail2/">Python Gmail - part 2</a></h4>
    
    
    <h5>October 9, 2017</h5>
    

     <kbd class="item-tag">gmail</kbd>  <kbd class="item-tag">python</kbd>  <kbd class="item-tag">find</kbd> 

</div>
 

    

    

</main>

        <footer>

            

        </footer>

    </body>

</html>

